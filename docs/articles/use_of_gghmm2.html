<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gghmm2">
<title>use_of_gghmm2 â€¢ gghmm2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="use_of_gghmm2">
<meta property="og:description" content="gghmm2">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gghmm2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/use_of_gghmm2.html">use_of_gghmm2</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AdvancedR-2021/gghmm2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>use_of_gghmm2</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AdvancedR-2021/gghmm2/blob/HEAD/vignettes/use_of_gghmm2.Rmd" class="external-link"><code>vignettes/use_of_gghmm2.Rmd</code></a></small>
      <div class="d-none name"><code>use_of_gghmm2.Rmd</code></div>
    </div>

    
    
<p>##Hidden Markov Model Hidden Markov model (HMM) is a statistical Markov model <em>S</em> where <em>S</em> is being model by a Markov process with hidden states. In other words <em>S</em> - which will be called the hidden state - can not be observed directly so we instead model on <em>X</em> which from now on will be called the observable states. Thus we learn about <em>S</em> at <em>t=t<sub>0</sub></em> from <em>X</em> at <em>t=t<sub>0</sub></em>.</p>
<div class="figure">
<img src="HMM.webp" style="width:50.0%" alt=""><p class="caption">Overview of a Hidden Markov model</p>
</div>
<div class="figure">
<img src="hmmm.png" style="width:20.0%" alt=""><p class="caption">Overview of hmm on google</p>
</div>
<p>##The package</p>
<p>To see how the package works, we will cover a example of it, using the earthquakes data contained in the package. First we load that data set and build the model we will be using. Here we use the HMM function to create the model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">earthquakes</span><span class="op">$</span><span class="va">n</span>
<span class="va">delta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>
<span class="va">trans</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">HM</span> <span class="op">=</span> <span class="fu"><a href="../reference/HMM.html">HMM</a></span><span class="op">(</span>stationary_dist <span class="op">=</span> <span class="va">delta</span>,transmission <span class="op">=</span> <span class="va">trans</span>,
         emission_function_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dpois"</span>,<span class="st">"dpois"</span><span class="op">)</span>,parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="va">HM</span>
<span class="co">#&gt; [1] "This is a Hidden Markov model with 2 hidden states."</span>
<span class="co">#&gt; [1] "It has the Statinonary distribution of:"</span>
<span class="co">#&gt; [1] 0.5 0.5</span>
<span class="co">#&gt; [1] "It has the transmision matrix:"</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]  0.9  0.1</span>
<span class="co">#&gt; [2,]  0.1  0.9</span>
<span class="co">#&gt; [1] "State 1  has the emission function dpois with parameters lambda = 10"</span>
<span class="co">#&gt; [1] "State 2  has the emission function dpois with parameters lambda = 30"</span></code></pre></div>
<p>Note that the print of the model, tells us how many hidden states the model has and all the parameters values.</p>
<p>To use the forward and backward algorithms, the user can use the forward and backward functions. They just need to be supplied with the the model as <em>HM</em> and the data as <em>X</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="va">FM</span> <span class="op">=</span> <span class="fu"><a href="../reference/forward.html">forward</a></span><span class="op">(</span><span class="va">HM</span>,<span class="va">X</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">FM</span><span class="op">[</span>,<span class="va">n</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 3.286743e-180</span>
<span class="va">BM</span> <span class="op">=</span> <span class="fu"><a href="../reference/backward.html">backward</a></span><span class="op">(</span><span class="va">HM</span>,<span class="va">X</span><span class="op">)</span></code></pre></div>
<p>To find the probability of being at a certain state <em>state</em> at a time <em>state<sub>time</sub></em>, we can use <em>state<sub>prob</sub></em>. Again the user also need to provide a model as <em>HMM</em> and the data as <em>X</em>. Note that we cannot calculate the probability for a time bigger then the size of the data. So if we have a sequence of <em>10</em> observation, then <em>state<sub>time</sub></em> cannot be larger then <em>10</em>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/state_prob.html">state_prob</a></span><span class="op">(</span>state <span class="op">=</span> <span class="fl">1</span>, state_time <span class="op">=</span> <span class="fl">10</span>, HM <span class="op">=</span> <span class="va">HM</span>, X <span class="op">=</span> <span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; [1] 7.169712e-09</span></code></pre></div>
<p>The package also have both a local and global decoder. The local decoder function is called <em>local<sub>decoder</sub></em> and will return a vector of hidden states.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/local_decoder.html">local_decoder</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">HM</span><span class="op">)</span>
<span class="co">#&gt;   [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 2 2 2 2 2 2 2 1 2 1 1 2 2 2</span>
<span class="co">#&gt;  [38] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 2 1 1 2 1 1 1 1 2 2 2 2 2 2 2 2 2</span>
<span class="co">#&gt;  [75] 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre></div>
<p>The global decoder is called Viterbi and will return a list. The list contains the path with the highest probability of emitting <em>X</em> and the probability of getting this path.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/viterbi.html">viterbi</a></span><span class="op">(</span><span class="va">HM</span>,<span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; $path</span>
<span class="co">#&gt;   [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 2 2 2 2 2 2 1 1 2 1 1 2 2 2</span>
<span class="co">#&gt;  [38] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 2 1 1 2 1 1 1 1 2 1 1 2 2 2 2 1 1</span>
<span class="co">#&gt;  [75] 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $path_prob</span>
<span class="co">#&gt; [1] 0.1137364</span></code></pre></div>
<p>The forecast function allow the used to check what the probability of getting a state at a time in future will be. Here the user need to provide the state as a index as the variable <em>pred<sub>obs</sub></em> , and the time as <em>pred<sub>time</sub></em>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/forecast.html">forecast</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span>,HM<span class="op">=</span><span class="va">HM</span>,X<span class="op">=</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.001134998</span></code></pre></div>
<p>To last the user can use the Expectationâ€“maximization algorithm to fit their data to a <em>HMM</em>. Here the user need to provide the data and a HMM object, which contain the initial guess for the parameters. The function will return <em>HMM</em> object, but now with the new parameters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HM2</span> <span class="op">=</span> <span class="fu"><a href="../reference/em.html">em</a></span><span class="op">(</span><span class="va">HM</span>,<span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; [1] "Number of iterations: 21"</span>
<span class="va">HM2</span>
<span class="co">#&gt; [1] "This is a Hidden Markov model with 2 hidden states."</span>
<span class="co">#&gt; [1] "It has the Statinonary distribution of:"</span>
<span class="co">#&gt; [1] 1.000000e+00 1.104646e-56</span>
<span class="co">#&gt; [1] "It has the transmision matrix:"</span>
<span class="co">#&gt;            [,1]     [,2]</span>
<span class="co">#&gt; [1,] 0.92837683 0.119045</span>
<span class="co">#&gt; [2,] 0.07162317 0.880955</span>
<span class="co">#&gt; [1] "State 1  has the emission function dpois with parameters lambda = 15.4205545371766"</span>
<span class="co">#&gt; [1] "State 2  has the emission function dpois with parameters lambda = 26.0175459459797"</span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Simon Lolk Lauridsen, Esben Skipper.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
